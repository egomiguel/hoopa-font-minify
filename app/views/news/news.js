"use strict";angular.module("myApp.News",["ngRoute"]).config(["$routeProvider",function(n){n.when("/news/:param1",{templateUrl:"views/news/news.html",controller:"NewsCtrl"})}]).controller("NewsCtrl",["$rootScope","$scope","$routeParams","$window",function(n,e,t,i){n.showBanner=!1,e.activeSideBar=t.param1,e.news=[],e.newsPagination=0,e.page=1,n.activeList="news",e.skip=0,e.pagNum=[],e.loading=!1,e.month=new Array,e.month[0]="January",e.month[1]="February",e.month[2]="March",e.month[3]="April",e.month[4]="May",e.month[5]="June",e.month[6]="July",e.month[7]="August",e.month[8]="September",e.month[9]="October",e.month[10]="November",e.month[11]="December",e.init=function(){e.loading=!0,new AV.Query("News").count().then(function(n){if(n>=5)if(n%5==0){e.newsPagination=parseInt(n/5);for(var t=1;t<e.newsPagination;t++)e.pagNum[t-1]=t}else{e.newsPagination=parseInt(n/5)+1;for(t=1;t<=e.newsPagination;t++)e.pagNum[t-1]=t}else e.newsPagination=0;e.$apply()});var n=new AV.Query("News");n.limit(5),n.find().then(function(n){e.news=[],n.forEach(function(n,t){var i=n.get("image").thumbnailURL(360,240),a=n.get("title"),o=n.get("content"),s=n.id,r=n.get("createdAt");e.news.push({id:s,mainImage:i,title:a,content:o,date:r}),e.getNewsMedia(n,e.news,t),e.$apply()}),e.loading=!1,e.$apply()}).catch(function(n){e.loading=!1,e.$apply(),alert(JSON.stringify(n))})},e.init(),e.getNewsMedia=function(n,t,i){var a=[],o=new AV.Query("NewsMedia");o.equalTo("news",n),o.find().then(function(n){n.forEach(function(n){if(n.get("image")){var e=n.get("image").thumbnailURL(360,240);a.push({image:e})}}),t[i].newsMedia=a,e.$apply()})},e.next=function(){e.page+=1,e.skip+=5;var n=new AV.Query("News");n.limit(5),n.skip(e.skip),n.find().then(function(n){e.news=[],n.forEach(function(n){var t=n.get("image").thumbnailURL(720,480),i=n.get("title"),a=n.get("content"),o=n.id;e.news.push({id:o,mainImage:t,title:i,content:a}),$("html,body").scrollTop(0),e.$apply()}),e.$apply()}).catch(function(n){e.loading=!1,e.$apply(),alert(JSON.stringify(n))})},e.previous=function(){if(e.skip>=5){e.page-=1,e.skip-=5;var n=new AV.Query("News");n.limit(5),n.skip(e.skip),n.find().then(function(n){e.news=[],n.forEach(function(n){var t=n.get("image").thumbnailURL(720,480),i=n.get("title"),a=n.get("content"),o=n.id;e.news.push({id:o,mainImage:t,title:i,content:a}),$("html,body").scrollTop(0),e.$apply()}),e.$apply()}).catch(function(n){e.loading=!1,e.$apply(),alert(JSON.stringify(n))})}},e.goToNews=function(n){localStorageService.cookie.set("newsId",e.news[n].id)},e.deleteNews=function(n){AV.Object.createWithoutData("News",n).destroy().then(function(n){e.init()})},e.ChangeNews=function(n){e.activeSideBar=n},e.goToPage=function(n){e.page=n,e.skip=5*(n-1);var t=new AV.Query("News");t.limit(5),t.skip(e.skip),t.find().then(function(n){e.news=[],n.forEach(function(n){var t=n.get("image").thumbnailURL(720,480),i=n.get("title"),a=n.get("content"),o=n.id;e.news.push({id:o,mainImage:t,title:i,content:a}),$("html,body").scrollTop(0),e.$apply()}),e.$apply()}).catch(function(n){e.loading=!1,e.$apply(),alert(JSON.stringify(n))})},e.goToProject=function(e){n.customGoTo("viewNews/"+e)}}]);